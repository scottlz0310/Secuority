# 実装計画

- [x] 1. プロジェクト構造とコアインターフェースの設定
  - プロジェクトディレクトリ構造を作成（models、core、cli、utils、templates）
  - システム境界を確立するインターフェースを定義
  - _要件: 1.1, 1.2, 1.3_

- [x] 2. データモデルと検証の実装
- [x] 2.1 コアデータモデルインターフェースと型の作成
  - すべてのデータモデル用のPythonインターフェースを記述
  - データ整合性のための検証関数を実装
  - _要件: 1.2, 2.1, 3.1_

- [x] 2.2 ProjectStateモデルの実装
  - 検証メソッドを持つProjectStateクラスを記述
  - _要件: 1.2, 1.3_

- [x] 2.3 ConfigChangeモデルの実装
  - 競合解決機能を持つConfigChangeクラスを実装
  - _要件: 7.1, 7.2_

- [ ]* 2.4 データモデルの単体テスト作成
  - ProjectStateモデル検証の単体テストを作成
  - 設定変更管理の単体テストを記述
  - _要件: 1.2, 7.1_

- [x] 3. プロジェクト分析エンジンの実装
- [x] 3.1 基本ファイル検出機能の実装
  - pyproject.toml、requirements.txt、setup.py、.gitignoreの存在確認
  - 既存設定ファイルの解析機能
  - _要件: 1.1, 1.2_

- [x] 3.2 依存関係分析機能の実装
  - requirements.txtの解析とパッケージリスト抽出
  - pyproject.tomlの依存関係セクション解析
  - extras検出とdependency-groups移行提案
  - _要件: 2.1, 2.5_

- [x] 3.3 他ツール検出機能の実装
  - Poetry、PDM、Setuptools-SCM設定の検出
  - 既存のlintツール設定（Ruff、Mypy）の検出
  - _要件: 2.4, 3.1, 3.2_

- [ ]* 3.4 プロジェクト分析の単体テスト作成
  - ファイル検出機能のテスト
  - 依存関係分析のテスト
  - _要件: 1.1, 2.1_

- [x] 4. テンプレート管理システムの実装
- [x] 4.1 テンプレートローダーの実装
  - OS適切な設定ディレクトリの決定
  - テンプレートファイルの読み込み機能
  - SECUORITY_TEMPLATES_DIR環境変数サポート
  - _要件: 8.1, 8.2_

- [x] 4.2 デフォルトテンプレートの作成
  - pyproject.toml.templateの作成（Ruff、Mypy、Bandit、Safety設定）
  - .gitignore.templateの作成（Python標準パターン）
  - .pre-commit-config.yaml.templateの作成（gitleaks設定）
  - _要件: 3.1, 4.1, 4.4, 5.1, 5.4_

- [x] 4.3 テンプレート更新機能の実装
  - リモートソースからのテンプレート取得
  - バージョン履歴の管理
  - _要件: 8.3, 8.4_

- [ ]* 4.4 テンプレート管理の単体テスト作成
  - テンプレートローダーのテスト
  - 更新機能のテスト
  - _要件: 8.1, 8.3_

- [x] 5. 設定適用エンジンの実装
- [x] 5.1 設定マージ機能の実装
  - 既存設定とテンプレートのマージロジック
  - 競合検出と解決プロンプト
  - _要件: 3.2, 3.3, 5.3, 7.5_

- [x] 5.2 ファイル操作とバックアップ機能の実装
  - 安全なファイル書き込み
  - 自動バックアップ作成
  - _要件: 2.2, 7.4_

- [x] 5.3 差分表示機能の実装
  - unified diff生成
  - ファイル単位での承認/拒否インターフェース
  - _要件: 7.1, 7.2_

- [ ]* 5.4 設定適用の単体テスト作成
  - マージ機能のテスト
  - バックアップ機能のテスト
  - _要件: 3.2, 7.4_

- [x] 6. GitHub統合機能の実装
- [x] 6.1 GitHub APIクライアントの実装
  - GITHUB_PERSONAL_ACCESS_TOKEN環境変数からの認証
  - Push Protection状態確認
  - Dependabot設定取得
  - _要件: 6.3, 9.2, 9.3_

- [x] 6.2 リポジトリ分析機能の実装
  - GitHub Actionsワークフロー検出
  - セキュリティ設定の確認
  - _要件: 9.1, 9.3_

- [x] 6.3 API エラーハンドリングの実装
  - API呼び出し失敗時の警告表示
  - 実行継続ロジック
  - _要件: 6.4, 6.5_

- [ ]* 6.4 GitHub統合の単体テスト作成
  - APIクライアントのモックテスト
  - エラーハンドリングのテスト
  - _要件: 6.3, 6.4_

- [x] 7. CLIインターフェースの実装
- [x] 7.1 基本CLIフレームワークの設定
  - Typerを使用したコマンド解析
  - メインエントリーポイントの作成
  - _要件: 1.1, 7.1_

- [x] 7.2 checkコマンドの実装
  - プロジェクト分析の実行
  - レポート生成と表示
  - --verboseフラグサポート
  - _要件: 1.1, 1.4, 1.5_

- [x] 7.3 applyコマンドの実装
  - 設定変更の適用
  - --dry-runフラグサポート
  - ユーザー確認プロンプト
  - _要件: 7.1, 7.2, 7.3_

- [x] 7.4 templateコマンドの実装
  - template listサブコマンド
  - template updateサブコマンド
  - _要件: 8.3, 8.4_

- [x] 7.5 initコマンドの実装
  - テンプレートディレクトリ初期化
  - config.yaml作成
  - _要件: 8.5_

- [ ]* 7.6 CLIコマンドの統合テスト作成
  - 各コマンドの動作テスト
  - エラーケースのテスト
  - _要件: 1.1, 7.1, 8.5_

- [x] 8. セキュリティ機能の統合
- [x] 8.1 セキュリティツール設定の実装
  - Bandit設定のpyproject.toml統合
  - Safety設定の追加
  - _要件: 5.1, 5.2_

- [x] 8.2 pre-commitフック設定の実装
  - gitleaks設定の追加
  - 既存.pre-commit-config.yamlとのマージ
  - _要件: 5.4, 6.1_

- [x] 8.3 CIワークフロー生成の実装
  - GitHub Actionsワークフローテンプレート
  - セキュリティチェック統合
  - _要件: 5.5, 6.2_

- [ ]* 8.4 セキュリティ機能の統合テスト作成
  - セキュリティツール設定のテスト
  - ワークフロー生成のテスト
  - _要件: 5.1, 5.5_

- [x] 9. エラーハンドリングとロギングの実装
- [x] 9.1 例外階層の実装
  - カスタム例外クラスの定義
  - 適切なエラーメッセージ
  - _要件: 全般_

- [x] 9.2 ロギングシステムの実装
  - logging.pyファイルの実装
  - 構造化ログ出力
  - デバッグレベルの設定
  - _要件: 1.5_

- [ ]* 9.3 エラーハンドリングのテスト作成
  - 例外処理のテスト
  - ログ出力のテスト
  - _要件: 全般_

- [-] 10. 最終統合とパッケージング
- [x] 10.1 CLIとコアエンジンの接続
  - CLIコマンドをコアエンジン機能と統合
  - プレースホルダー実装を実際の分析・適用機能に置き換え
  - _要件: 1.1, 7.1, 7.2, 7.3_

- [x] 10.2 完全なcheckコマンド機能の実装
  - checkコマンドをProjectAnalyzerに接続
  - 包括的な分析結果の表示
  - セキュリティと品質ツールの推奨事項表示
  - _要件: 1.1, 1.4, 1.5, 2.1, 3.1, 3.2_

- [-] 10.3 完全なapplyコマンド機能の実装
  - applyコマンドをConfigurationApplierに接続
  - 実際の設定変更の生成と適用
  - ユーザー確認と競合解決の処理
  - _要件: 7.1, 7.2, 7.3, 3.2, 3.3_

- [x] 10.4 不足しているテンプレートファイルの作成
  - Pythonパターンを含む.gitignore.templateの作成
  - セキュリティフックを含む.pre-commit-config.yaml.templateの作成
  - GitHub Actionsワークフローテンプレートの作成
  - _要件: 4.1, 4.4, 5.4, 5.5, 6.2_

- [ ] 10.5 CLIエントリーポイントの設定
  - pyproject.tomlでCLIエントリーポイントを設定
  - パッケージメタデータの完成
  - _要件: 全般_

- [ ] 10.6 テンプレート初期化の実装
  - デフォルトテンプレートをユーザー設定ディレクトリにコピー
  - 初期設定ファイルのセットアップ
  - _要件: 8.1, 8.5_

- [ ]* 10.7 エンドツーエンドテストの作成
  - 実際のプロジェクトでの完全なワークフローテスト
  - 全コマンド統合のテスト
  - _要件: 全般_
